<div class="bg-[url(/jj-bg.webp)] h-full flex-1 bg-cover bg-center flex flex-col">
  <div class="flex justify-end gap-4 p-5 bg-white/20 shadow-b-lg">
    <button
      class="rounded-full bg-slate-50 hover:bg-slate-100 border border-slate-200 px-4 py-2"
      (click)="sortByDate()"
    >
      Trier par date décroissante
    </button>
    <button
      class="rounded-full bg-slate-50 hover:bg-slate-100 border border-slate-200 px-4 py-2"
      (click)="resetSorting()"
    >
      Réinitialiser le tri
    </button>
  </div>

  @if(selectedPollution$ | async; as selectedPollution){
  <app-pollution-details-modal
    [pollution]="selectedPollution"
    [closeModal]="closeModal"
  ></app-pollution-details-modal>
  }

  <!-- Scrollable list area -->
  @if(pollutionList$ | async; as pollutionList){
  <div class="flex-1 overflow-auto">
    <div class="m-2 grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
      @for(pollution of pollutionList; track $index){
      <div
        class="rounded-xl p-5 shadow-md border border-green-300 bg-gradient-to-br from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 transition"
      >
        <h3 class="text-lg font-semibold text-green-800 mb-2">{{ pollution.type_pollution }}</h3>

        <p class="mb-1 text-green-700">
          <strong>Localisation :</strong> {{ pollution.latitude }} : {{ pollution.longitude }}
        </p>

        <p class="mb-1 text-green-700">
          <strong>Description :</strong> {{ pollution.description }}
        </p>

        <p class="mb-3 text-green-700">
          <strong>Date :</strong> {{ pollution.date_observation | date : 'medium' }}
        </p>

        <div class="flex justify-between">
          <button
            (click)="deletePollution(pollution.id)"
            class="flex items-center px-3 py-1 bg-red-100 rounded hover:bg-red-200 transition"
          >
            <lucide-icon [img]="Trash" class="w-6 h-6 text-red-600"></lucide-icon>
          </button>

          <button
            (click)="showDetails(pollution.id)"
            class="flex items-center gap-1 px-3 py-1 bg-green-200 rounded hover:bg-green-300 transition"
          >
            <lucide-icon [img]="Info" class="w-5 h-5 text-green-700"></lucide-icon>
            <span class="text-green-800 font-medium">Détails</span>
          </button>
        </div>
      </div>
      }
    </div>
  </div>
  } @else {
  <p class="p-4">Chargement de la liste...</p>
  }
</div>
